import math
import matplotlib.pyplot as plt
from scipy import optimize
from scipy import stats
from numpy import linspace




class ResultDist:

    dist_types = ['norm.cdf', 'lognorm.cdf', 'uniform.cdf', 'triang.cdf']

    def __init__(self, values):

        self.values = values
        self.values.sort()
        self.bin_size = self.bin_size()
        self.hist = self.make_pdf_hist()
        self.cdfs = self.make_cdfs()
        self.index = 0
        self.plot_info()



    def __str__(self):

        string = 'values: '
        for num in self.values:
            string += (str(num) + ' ')
        string += '\n\t\t\t'
        string += ('Bin Width: ' + str(self.bin_size))
        return string

    def bin_size(self):

        return (2*self.IQR())/(math.pow(len(self.values),(1/3)))

    def IQR(self):

        l = self.values[:len(self.values)//2]
        q1 = l[len(l)//2]
        l = self.values[len(self.values)//2:]
        q3 = l[len(l)//2]

        return q3-q1


    def make_pdf_hist(self) -> dict:


        hist = {}
        num_bin = int((self.values[len(self.values)-1] - self.values[0])//self.bin_size) + 1
        bins = linspace(self.values[0],self.values[len(self.values)-1], num_bin)

        for i in range (num_bin):
            hist[bins[i]] = 0

        for i in range (len(self.values)):
            bottom = self.values[0]
            top = bottom + self.bin_size
            hist_add_value = 1/len(self.values)
            for j in range (num_bin):
                if self.values[i] < top and self.values[i] >= bottom:
                    hist[bins[j]] += hist_add_value
                bottom = top
                top = bottom + self.bin_size

        total = 0



        return hist

    def plot_info(self):

        x_axis = []


        mean = self.cdfs[self.index][1]
        std = self.cdfs[self.index][2]
        print(mean,std)
        totalwidth = ((mean + 3*std) - (mean - 3*std))
        interval = totalwidth/100
        x = []
        for i in range (100):
            x.append(interval*i)

        fig, ax = plt.subplots(1, 1)
        # histogram
        hist_plot = list(sorted(self.hist.items(), key=lambda x: x[0]))
        x = [i[0] for i in hist_plot]
        y = [i[1] for i in hist_plot]
        #print(hist_plot)
        plt.plot(x, y, 'ro',color='r')
        # fitted cdf
        ax.plot(x,stats.norm.pdf(x, loc=mean, scale=std))
        plt.show()

    def make_cdfs(self):

        width = 1/len(self.values)
        y = []
        for i in range (len(self.values)):
            y.append(0+(width*i))

        cdf_list = [[stats.norm.cdf], [stats.lognorm.cdf], [stats.uniform.cdf], [stats.triang.cdf]]

        for i in range (len(cdf_list)):
            mean, std = optimize.curve_fit(cdf_list[i][0], self.values, y, p0=[0,1])[0]
            cdf_list[i].extend((mean, std))

        return cdf_list
        #print(cdf_list)


    def kd_cdf(self):

        for i in range (len(self.dist_types)):
            stats.kstest(self.values, self.dist_types[i])






a = ResultDist([2.735902999308196, 4.138556858568244, 3.6761820299110632, 3.4137659534403237, 2.629734716722759, 2.574263204553427, 3.8058372929870696, 3.344601722955248, 3.2448017210447455, 2.5082643818445085, 3.768760052459628, 3.321084856045749, 2.4077566885153305, 3.084213834058964, 3.9793696038303548, 4.130265152351035, 3.47210385894311, 4.249360497670831, 3.673401078027297, 3.1378525249011844, 3.4388942157892797, 2.9233101577121086, 3.4635730108245424, 3.8574317038713524, 3.3403533770480323, 3.5152493991086065, 2.83807747558385, 2.760795026000138, 3.1361643062608486, 3.618079373239022, 2.8534423536400877, 4.28110770397692, 3.8136118305141617, 3.5392459916352443, 2.7462677139015756, 2.683731405477287, 3.9455754626678816, 3.47305299203132, 3.3715265178955782, 2.621454739620178, 3.9046719895299353, 3.4496088118231425, 2.5206104797199127, 3.2109409766308277, 4.117579341837152, 4.274078314287796, 3.6007482000153606, 4.3958593068661544, 3.8064162515742694, 3.2597569833108646, 3.568894482285934, 3.043651136260436, 3.5923247366541116, 3.993874798758244, 3.4676448556525776, 3.6489033436930933, 2.956108589206994, 2.875540664496269, 3.261949986041025, 3.7528685376745314, 2.5225833979586376, 3.898446546042711, 3.437714081781251, 3.1984063412372223, 2.416401421609362, 2.3756953065947553, 3.5650426744069383, 3.1199240273776865, 3.0186460098013432, 2.3011680443460123, 3.5377589033205985, 3.095765995295544, 2.1980769419008714, 2.8553182009704288, 3.745966208974013, 3.8888878561620492, 3.2475097391748764, 4.00259545420285, 3.4454175236205034, 2.9236201841900473, 3.209670068467265, 2.7083516373286356, 3.240046077994866, 3.6262025165645104, 3.119626447599417, 3.2803453790919983, 2.6264263875033858, 2.5553009881321525, 2.913400609237674, 3.3841129650278754, 2.6389274873605406, 4.049019158265574, 3.5843228537521585, 3.3268211349563157, 2.5295575254054534, 2.47977038380165, 3.7112644210191825, 3.254823659796316, 3.1472042139535614, 2.4099260592343774, 3.674281078433046, 3.2224855333880322, 2.3038511851929786, 2.9847242737871023, 3.8944545898085305, 4.044237383312987, 3.3754408533359355, 4.152901845874032, 3.5856132855376353, 3.0466127324098933, 3.346832431141379, 2.8323656255354863, 3.372322203194869, 3.76882391355252, 3.249035801841586, 3.417260288479244, 2.74912921401406, 2.670735264525866, 3.037413839244038, 3.525658516141489, 2.4238948526838326, 3.562668318569081, 3.1926827446380157, 2.963729536250907, 2.341277106665645, 2.280778545007613, 3.300726302522109, 2.9156393960029345, 2.8366303539632245, 2.24008853735302, 3.267108022055466, 2.904174334526115, 2.1635739820599014, 2.712888945175426, 3.4268613838630517, 3.5580578710381694, 3.0187643541964326, 3.6618662994927234, 3.1801044344862546, 2.7429633895599848, 2.990569369099446, 2.5720568302152884, 3.0097505574564947, 3.331901289354882, 2.91317127712391, 3.0626505037960254, 2.499416483043941, 2.434233736146214, 2.7547326701692088, 3.14253045472709, 2.81496119591734, 4.252135081112441, 3.778685788635357, 3.51012343259896, 2.7064560489228002, 2.648277918275081, 3.911927205353665, 3.438802954150455, 3.3334984529733864, 2.583027393603392, 3.8755663735198977, 3.415417992237465, 2.4792855132758693, 3.1701840896158724, 4.088719226292749, 4.245515655901588, 3.5672843010447752, 4.366395660162308, 3.7755287371435555, 3.226609070045972, 3.532264681429067, 3.007332635821, 3.5598278573320834, 3.964892830963512, 3.435951878760994, 3.612329589067042, 2.919597291999163, 2.840589383732432, 3.226284337353852, 3.7186804946759033, 2.6736995010796694, 4.069525811951667, 3.6071135220787856, 3.3525736631995184, 2.5675036616299836, 2.51619030800079, 3.736440364180666, 3.279684936803173, 3.176984098396851, 2.448742161978842, 3.7038874303088916, 3.2563255840531986, 2.34656300978385, 3.016000924747287, 3.912220970572741, 4.06216209903456, 3.4058562017545237, 4.178658851932304, 3.6078051121361883, 3.0759507055284456, 3.370313465882268, 2.8611708758417684, 3.3986307433991905, 3.791592333346516, 3.2778693649469264, 3.4460555826523875, 2.7766752279142968, 2.70151825465277, 3.072210878377386, 3.550139476114103, 2.651646882689121, 4.0763447541980184, 3.6039817505651577, 3.34882316776622, 2.5415265753578122, 2.4937256239844054, 3.7338909690958073, 3.2724896138827058, 3.163794532900365, 2.4217765856676423, 3.7009587311287127, 3.243286661612993, 2.3144255975240315, 2.9982951608769697, 3.9192915432680326, 4.070417622095505, 3.3973861339718403, 4.182879670157321, 3.607742765027347, 3.0647597277413134, 3.363861555436786, 2.846003530708585, 3.393028752304804, 3.794102781113859, 3.269611285231024, 3.4368047476165717, 2.7613871768184888, 2.684481930310805, 3.0557298627418015, 3.545966928325795, 2.436832871548001, 3.6012301211052358, 3.2171357310519704, 2.993108688834611, 2.352805898972721, 2.2969120796939535, 3.330460238306604, 2.9369616617440806, 2.857357935115085, 2.251148963606722, 3.3039595065245404, 2.9311790976455483, 2.1726614857777267, 2.727537172990315, 3.4611008448345113, 3.5935221261057637, 3.0490121097695106, 3.704934346848728, 3.2095236235036535, 2.7657653436915886, 3.011898295741026, 2.58630134469453, 3.0371189512896843, 3.366668425807604, 2.939386755823784, 3.0878033367496225, 2.511366429044598, 2.449114403385694, 2.7771290207353303, 3.1685705149551144, 2.8962394564224745, 4.327160550808334, 3.8592619733172575, 3.5813798830665426, 2.7895112662521737, 2.7243933293720692, 3.992153483198508, 3.516499427795568, 3.4163688449807443, 2.6635939846667274, 3.950265095917812, 3.494739984106071, 2.563875785026597, 3.256185491811809, 4.161886078280912, 4.319616775520926, 3.6456194821927057, 4.44401778257024, 3.850291926085514, 3.3021625996988324, 3.613284101503752, 3.0857629337027053, 3.6360962201879703, 4.038500516938753, 3.5110176408146243, 3.695090471898615, 2.997397830827484, 2.916335522830069, 3.3065964068107427, 3.7980975446525105, 2.3271778979043853, 3.4736792003979517, 3.0960540589381114, 2.8781738286804326, 2.2425769698609903, 2.191374868127322, 3.204952666416894, 2.8223467661901345, 2.740850385505429, 2.1433194645371825, 3.1773007710407093, 2.8101037735727923, 2.063273452785141, 2.6120681072793395, 3.339473758562832, 3.4676820103110435, 2.928307608285705, 3.570390525442526, 3.090723320499356, 2.6531397041667457, 2.8962454650708027, 2.4775823577049816, 2.9196577942338497, 3.243671474477187, 2.822430215574762, 2.9657434262372147, 2.4056370886423637, 2.343314594919952, 2.6589093954607206, 3.048021437469324, 2.801897753088613, 4.237804296728139, 3.7595136705792633, 3.4983430050490183, 2.694514944098459, 2.6405216423489115, 3.8959581623916786, 3.421693422511984, 3.320482773129743, 2.5718039359780898, 3.8660456129363308, 3.405733828267971, 2.46953963964506, 3.154258777269061, 4.072039588224523, 4.227031466347233, 3.5586716701013734, 4.355778058723709, 3.7600148152016857, 3.214661903924786, 3.5153289063581328, 2.990829052581509, 3.5469410796945113, 3.9511621371225294, 3.423187571131702, 3.5984081847306437, 2.902050962777877, 2.8271542616101026, 3.2153267077287166, 3.702184675965872, 2.605362484278178, 3.7976930515140452, 3.411350481061481, 3.1672688602490853, 2.52023461426755, 2.4521922107194283, 3.5259186473767197, 3.1188712098088724, 3.037269369792046, 2.4135263573807673, 3.490445086262455, 3.1105605456298093, 2.335333314778903, 2.909595260119953, 3.6528866890694047, 3.7928901665534847, 3.2278864016471087, 3.9052657272539286, 3.3952118770213966, 2.937170462119222, 3.1967002873155543, 2.7586494765978524, 3.2171963841334406, 3.5552464283916994, 3.1172434495190307, 3.2761220159352655, 2.681254617833033, 2.6127779415823573, 2.9541217195724787, 3.35821354261438, 2.6674007399657578, 4.038863360720078, 3.582196034256424, 3.3324283498570795, 2.564552460475017, 2.513599632413459, 3.7120313366970095, 3.2596404973693764, 3.164003728830963, 2.4469052932471307, 3.682374508323492, 3.2433506933157994, 2.349334652258073, 3.004765962467473, 3.881008378365904, 4.028080689558602, 3.390787667661276, 4.150733753459745, 3.5827572744405245, 3.06177746558766, 3.350495844860653, 2.848045574190238, 3.3793680165442415, 3.7647830001566023, 3.2600852103749176, 3.42856788884199, 2.7635913380193773, 2.691719379975437, 3.0614360076587595, 3.5275102559458547, 2.8197206603376403, 4.244866899363461, 3.773136790092613, 3.50724841723286, 2.713291678418052, 2.655835538016022, 3.9075189526309755, 3.4355271883830105, 3.3367551161750852, 2.5897353506601073, 3.8729900667577337, 3.4178444812445727, 2.489540341015483, 3.1733495317043245, 4.080125907345179, 4.23447363538024, 3.570005565073123, 4.361862198465193, 3.7701704316909743, 3.227350814738719, 3.530906229771623, 3.00728666757687, 3.5584016202722695, 3.9589043744783923, 3.4341178576887943, 3.6127355360496765, 2.9192157941532813, 2.842587571955362, 3.229272333721809, 3.7149846656707575, 3.003449960515258, 4.46401140402014, 3.9817290616645242, 3.701849013797758, 2.89679226099116, 2.8306826294445586, 4.122143078655847, 3.6316369683950676, 3.5348724648093164, 2.7681836907946873, 4.085864589661042, 3.6204930164247764, 2.669604984530764, 3.3696970110406315, 4.290392193296348, 4.4517993003518646, 3.773638736404395, 4.590550720737665, 3.9738719770526822, 3.417377232184828, 3.7303579104624935, 3.1917843966178143, 3.7581817480820283, 4.168964903701514, 3.63140429367378, 3.8204830562406085, 3.0992493176471925, 3.0205922500192424, 3.426927907640849, 3.9215658702439944, 2.169042930693319, 3.261516180279236, 2.897437388263743, 2.6981943830710926, 2.0883270722314577, 2.044956829502839, 3.00275422795019, 2.6395113282195464, 2.561937620909717, 1.9953709164159974, 2.982167374279343, 2.630834458348357, 1.9181923567987085, 2.436501008871262, 3.133558893241209, 3.2540712159131067, 2.744401973263895, 3.354151053404399, 2.896866275227018, 2.4821916280719987, 2.708565711838252, 2.3116194500959906, 2.73487075740765, 3.043705289849019, 2.6429210629502826, 2.7752675979830372, 2.242985447612934, 2.186708092799196, 2.4859467177118244, 2.85366290024779, 2.8112121487966153, 4.246146507167056, 3.772415800813636, 3.5054104697750743, 2.7031330787918204, 2.645734096377892, 3.9061556227356733, 3.433287483829814, 3.3293326434601185, 2.579866643247789, 3.8709466187810566, 3.411559409077617, 2.4767546411179504, 3.1656445708486847, 4.082366792389377, 4.238515615991383, 3.5635748400050087, 4.361132026163246, 3.7698501511870393, 3.2224006054141126, 3.526949203514176, 3.002486562246982, 3.555066147207582, 3.9592891573423517, 3.431208123919228, 3.607544621571445, 2.914627874661035, 2.8365175408774914, 3.2223998966873295, 3.713039699041952, 2.8951059933268235, 4.331999862402913, 3.8579796982408907, 3.5850073834933673, 2.788640430997788, 2.726743141151111, 3.9939361938920066, 3.5153816070060495, 3.4173768053764624, 2.6629064491316305, 3.957152960615266, 3.4990563327143165, 2.5635494885770305, 3.2541414292824373, 4.164301146920625, 4.321444900441639, 3.6513318881577157, 4.452063773933961, 3.8520777671930646, 3.3040745135213334, 3.6123517456455905, 3.083100402273613, 3.6387501245261458, 4.042605997588777, 3.5133974081634105, 3.6967959552829446, 2.9935628868117266, 2.9153708120158464, 3.309050758491066, 3.7986011478369153, 2.271422354226939, 3.58288771773548, 3.140621413772624, 2.924241990927426, 2.167843192473056, 2.138351981337447, 3.2602105002717194, 2.843192124970009, 2.74061440819719, 2.0613020746255737, 3.238733609124301, 2.814894274569276, 1.9580617682653858, 2.58191191618579, 3.442210726244754, 3.5754747199350403, 2.961373021648773, 3.6760264405694545, 3.1548954606965784, 2.6587264934685093, 2.9254782544709217, 2.4522598095137025, 2.957906772000074, 3.326465472466457, 2.8440468468422093, 2.987658958356729, 2.3762399125470193, 2.3101688484286598, 2.641141639542268, 3.090835845495748, 2.822114247978934, 4.239464647313599, 3.770078885905178, 3.505957491187866, 2.716793277636732, 2.6584732266507176, 3.9046177499178607, 3.4340256319223674, 3.3345076444291, 2.5945190329683334, 3.872067319328352, 3.4183912278021062, 2.494858878465846, 3.1727381134005834, 4.0746870009625304, 4.229900590577051, 3.567566374426135, 4.357373685794754, 3.7668549800483073, 3.2271826773851364, 3.5267801588582484, 3.0081941786658386, 3.5561282539173638, 3.955500648056169, 3.434287158742592, 3.6103670647876687, 2.9199862967983696, 2.8443216062834176, 3.2309054653185942, 3.7121388227337473, 2.988444946789936, 4.440926221258429, 3.9634263393913898, 3.6834189057889475, 2.8819537176024728, 2.814327718207441, 4.101848306592031, 3.6149189641930204, 3.514299106356956, 2.754852954673019, 4.064770590682063, 3.6008824799483907, 2.6552542039604434, 3.351923160577371, 4.2694555189173, 4.432054564633841, 3.750729524966782, 4.565225640676315, 3.9544862114920276, 3.3997706171148874, 3.7103832502561542, 3.1776654282715087, 3.7383598428464793, 4.14824193715782, 3.6141412444287906, 3.7996514839969957, 3.0859789092037215, 3.006380148087593, 3.409233703583505, 3.90228419129219, 2.7085590473305436, 4.089011466121572, 3.6317428538697585, 3.3765962737237127, 2.6050425897709677, 2.550632066307623, 3.7615935738111577, 3.305769164075188, 3.207344908992453, 2.486501234100045, 3.72965406706964, 3.2875714141402104, 2.3879866686154023, 3.049054328098171, 3.930378760444558, 4.08034382838643, 3.4340476670302453, 4.201228029644447, 3.630081847297386, 3.1043467517135652, 3.396066747987576, 2.8913279390886397, 3.424287081960987, 3.813037973181822, 3.3051919171755255, 3.4749161669007194, 2.806320686335688, 2.732394634043537, 3.1051310578552687, 3.575388020517305, 2.9969941095733397, 4.454687740817464, 3.9750106883230107, 3.694481697610929, 2.8901722147819253, 2.822810810063757, 4.114143522378926, 3.6253956433210455, 3.5252275942421814, 2.762492961352737, 4.077173923268803, 3.6118201500533162, 2.6627893258553117, 3.361846435338787, 4.282430390155911, 4.445137086102542, 3.76273747700847, 4.579651144079537, 3.966355927784607, 3.409925243586949, 3.72172125816675, 3.186556780103303, 3.749767116761411, 4.160840542287019, 3.6247238640634776, 3.8112990983842776, 3.0945048086983262, 3.014915670239598, 3.419314123579838, 3.9139306257722377, 2.4969046816943585, 3.882735900293911, 3.4186130055357986, 3.1810752718330817, 2.388983272951805, 2.3500914066302037, 3.545762271289375, 3.100286901730556, 2.993243700147547, 2.274744619746698, 3.519849716345228, 3.07287489761983, 2.1681963129996626, 2.828857686326305, 3.7312971032578837, 3.875704202214042, 3.2244743704919694, 3.9849094626831887, 3.4282545311079984, 2.9024557281763546, 3.1874156506438487, 2.686355447704714, 3.2200110297631004, 3.6101645948195666, 3.1005232133571186, 3.257062268196204, 2.604629171940642, 2.533016011280801, 2.8896990180430744, 3.3643588820564863, 2.334445359755732, 3.6555604596557223, 3.2132944866346502, 2.988421306090044, 2.2303923001546364, 2.1960167635096752, 3.3328579937120804, 2.911161679468567, 2.8082899988697556, 2.1216472310281858, 3.3068391026293877, 2.881067845839922, 2.018711889511534, 2.650614957503171, 3.5134603755225697, 3.649193378569009, 3.027756247089808, 3.7496344274629507, 3.223886772424781, 2.7223567260443455, 2.9952558516019296, 2.5167946741680836, 3.024845649930321, 3.396044248063529, 2.9096369208268573, 3.0580641013716523, 2.4400736371489615, 2.371189265049817, 2.70660687513416, 3.1616242367284992, 3.035874532127037, 4.509218874229599, 4.028103249992457, 3.7378199106826995, 2.927078181440306, 2.8567217429345595, 4.16603425458868, 3.6730779434439507, 3.573311596430189, 2.7959896520876213, 4.121542342080265, 3.653698947519571, 2.6956750009138153, 3.409178690220241, 4.33681180997551, 4.50000801488233, 3.8087144942422375, 4.632501592040637, 4.01639840529172, 3.4518929910843186, 3.7744699575515765, 3.2289940632013354, 3.796737925915564, 4.210641272112908, 3.667282579436266, 3.8610711874046917, 3.1370446469280133, 3.0533085533796918, 3.459737927986696, 3.9649340448082193, 2.434576144713347, 3.5768894176481907, 3.200559569282703, 2.976848597824256, 2.353012031463649, 2.295747003107727, 3.312561340810796, 2.923845683256691, 2.8501705582409476, 2.2515127099321997, 3.284632457110052, 2.9206060302902794, 2.1769877446761496, 2.722985955466872, 3.4375194594285174, 3.5672456785377706, 3.03717776332232, 3.6810081196616817, 3.1909685068900813, 2.755588974679529, 3.000356188977413, 2.579224435867078, 3.0229472395811983, 3.345201356077924, 2.9254459641909696, 3.0761555849559787, 2.505012436692313, 2.443604082190876, 2.7691125558697034, 3.1529428545801643, 2.7061993359890626, 4.104971671101928, 3.6434275377346754, 3.384424847454808, 2.5999577540749, 2.545853064999631, 3.772536572802937, 3.313866532028629, 3.21120799356161, 2.480144825151766, 3.737460309515389, 3.289610157484531, 2.378364476015442, 3.0511441870341196, 3.947086017699052, 4.098228624500359, 3.4389251233316207, 4.214521420352776, 3.6419566936595413, 3.108013034357302, 3.405340203284335, 2.894150885855279, 3.4320013188582483, 3.825770178340678, 3.310727982044348, 3.4813900711509493, 2.809380038800672, 2.732754127723905, 3.1054297033029807, 3.585469531224534, 3.0606945553335723, 4.550753821725262, 4.060417805963584, 3.7736150193461877, 2.951431028917746, 2.8827965343166526, 4.20251827144019, 3.7030853344639496, 3.600991735942331, 2.8207930448072926, 4.164413377604987, 3.688956903204754, 2.718929931355737, 3.433834802058587, 4.374796020222979, 4.540744105489374, 3.843627587896644, 4.678270590809287, 4.051630710028374, 3.482844470369686, 3.801957237666859, 3.2544865489998633, 3.8302938095866423, 4.250273525168128, 3.702109249555764, 3.893180334998063, 3.1604829496602904, 3.079066890191758, 3.49214818002757, 3.99802847331126])

